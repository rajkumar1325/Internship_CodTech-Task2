<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Todo List</title>
    <style>
        /* Resetting all defaults styles and set box-sizing */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        /* Set minimum height for full screen and create gradient background */
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #669db9 0%, #000000 100%);
            padding: 20px;
            color: #ff0000;
        }

        /* Center container and set maximum width */
        .container {
            max-width: 600px;
            margin: 20px auto;
        }

        /* Style main heading with glow effect */
        h1 {
            font-size: 4rem;
            text-align: center;
            color: #ffd1dc;
            margin-bottom: 40px;
            text-shadow: 0 0 20px rgba(255, 209, 220, 0.5);
        }

        /* Style input section with flexbox layout */
        .input-section {
            
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        /* Style the task input field */
        #todo-input {
            
            flex: 1;
            padding: 15px 20px;
            font-size: 1rem;
            background: rgba(0, 0, 0, 0.6);
            border: none;
            border-radius: 25px;
            color: #fff;
        }

        /* Style placeholder text in input field */
        #todo-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        /* Style the "I Got This!" button */
        #add-btn {
            padding: 15px 30px;
            color: #1a2a32;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        /* Add hover effect to add button */
        #add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 209, 220, 0.3);
        }

        /* Style timestamp display */
        .timestamp {
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        /* Style individual todo items */
        .todo-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.6);
            margin-bottom: 10px;
            border-radius: 25px;
            animation: slideIn 0.3s ease;
        }

        /* Define slide-in animation for new todos */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Style todo text content */
        .todo-text {
            flex: 1;
            margin: 0 15px;
            color: #fff;
        }

        /* Style completed todo items */
        .todo-item.completed .todo-text {
            text-decoration: line-through;
            opacity: 0.6;
        }

        /* Common styles for action buttons */
        .btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
            transition: all 0.3s ease;
        }

        /* Style complete button */
        .complete-btn {
            background: #ffd1dc;
            color: #1a2a32;
        }

        /* Style delete button */
        .delete-btn {
            background: #ff4757;
            color: #fff;
        }

        /* Add hover effect to buttons */
        .btn:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- Main container for the app -->
    <div class="container">
        <!-- Main heading -->
        <h1>Just do it.</h1>
        <!-- Input section for new tasks -->
        <div class="input-section">
            <input type="text" id="todo-input" placeholder="Add a task.">
            <button id="add-btn">I Got This!</button>
        </div>
        <!-- Container for timestamp -->
        <div class="timestamp"></div>
        <!-- Container for todo list items -->
        <div id="todo-list"></div>
    </div>

    <script>
        // Main TodoApp class to handle all functionality
        class TodoApp {


//////////////////////////////1. Class Initialization

/*
This is called when the "TodoApp" class is instantiated. It initializes the application.
Retrieves previously stored todos from "sessionStorage" or sets an empty array if none exist.
Sets references to important DOM elements ("input", "list", and "timestamp").
Calls methods to set up the UI ("updateTimestamp", "initializeEventListeners", and "renderTodos").
Updates the timestamp every second using "setInterval".
*/
            constructor() {
                // Initialize todos from session storage or empty array
                this.todos = JSON.parse(sessionStorage.getItem('todos')) || [];
                // Get references to DOM elements
                this.todoInput = document.getElementById('todo-input');
                this.todoList = document.getElementById('todo-list');
                this.timestamp = document.querySelector('.timestamp');
                
                // Initialize app components
                this.updateTimestamp();
                this.initializeEventListeners();
                this.renderTodos();

                // Set interval to update timestamp every second
                setInterval(() => this.updateTimestamp(), 1000);
            }

////////////////////////////////////2. Timestamp Handling

/*Gets the current date and time using "new Date()."
Formats it into a readable string using "toLocaleString()" with custom options like "hour12" format.
Updates the ".timestamp" element in the DOM with the new timestamp.*/

            updateTimestamp() {
                const now = new Date();
                this.timestamp.textContent = now.toLocaleString('en-US', {
                    month: 'numeric',
                    day: 'numeric',
                    year: 'numeric',
                    hour: 'numeric',
                    minute: 'numeric',
                    second: 'numeric',
                    hour12: true
                });
            }

//////////////////////////////////////////3. Event Listeners

/*Adds a click listener to the "Add Task" button to call "addTodo()" when clicked.
Listens for the Enter key in the input field to also trigger "addTodo()".*/
            initializeEventListeners() {
                // Listen for click on add button
                document.getElementById('add-btn').addEventListener('click', () => this.addTodo());
                // Listen for Enter key in input field
                this.todoInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.addTodo();
                });
            }


/////////////////////////////////////4. Adding a New Todo

/*Reads the input value "(todoText)" and trims any whitespace.
If the input is not empty:
    Creates a new todo object with:
                id: A unique ID using "Date.now()".
                text: The input value.
                completed: A boolean indicating whether the task is done (default "false").
Adds the todo to the "todos" array.
Saves the updated todos to "sessionStorage".
Updates the UI by calling "renderTodos()".
Clears the input field.*/

            // Add new todo item
            addTodo() {
                const todoText = this.todoInput.value.trim();
                if (todoText) {
                    // Create new todo object
                    const todo = {
                        id: Date.now(),
                        text: todoText,
                        completed: false
                    };
                    // Add to todos array
                    this.todos.push(todo);
                    // Save to session storage
                    this.saveTodos();
                    // Update UI
                    this.renderTodos();
                    // Clear input field
                    this.todoInput.value = '';
                }
            }




////////////////////////////////5. Managing Todos

/*toggleTodo(id):

Finds the todo with the specified "id" and toggles its "completed" status.
Updates the todos in "sessionStorage" and re-renders the list.
*/
            // Toggle todo completion status
            toggleTodo(id) {
                // Map through todos and toggle matched id
                this.todos = this.todos.map(todo => 
                    todo.id === id ? {...todo, completed: !todo.completed} : todo
                );
                this.saveTodos();
                this.renderTodos();
            }

/*
deleteTodo(id):

Removes the todo with the specified "id" from the "todos" array.
Saves the updated list to "sessionStorage" and re-renders the list.*/

            // Delete todo item
            deleteTodo(id) {
                // Filter out todo with matching id
                this.todos = this.todos.filter(todo => todo.id !== id);
                this.saveTodos();
                this.renderTodos();
            }

//////////////////////////////////6. Saving and Rendering


            // Save todos to session storage
            saveTodos() {
                sessionStorage.setItem('todos', JSON.stringify(this.todos));
            }

            // Render todos to DOM
            renderTodos() {
                // Map todos array to HTML string
                this.todoList.innerHTML = this.todos
                    .map(todo => `
                        <div class="todo-item ${todo.completed ? 'completed' : ''}">
                            <span class="todo-text">${this.escapeHtml(todo.text)}</span>
                            <button class="btn complete-btn" onclick="todoApp.toggleTodo(${todo.id})">✓</button>
                            <button class="btn delete-btn" onclick="todoApp.deleteTodo(${todo.id})">×</button>
                        </div>
                    `)
                    .join('');
            }

/////////////////////////////7. XSS Prevention
/*Ensures that user-provided text is escaped to prevent Cross-Site Scripting (XSS) attacks.
Replaces characters like "<" and ">" with their HTML entities (&lt; and &gt;).*/

            // Escape HTML to prevent XSS attacks
            escapeHtml(unsafe) {
                return unsafe
                    .replace(/&/g, "&amp;")     // Replace & with HTML entity
                    .replace(/</g, "&lt;")      // Replace < with HTML entity
                    .replace(/>/g, "&gt;")      // Replace > with HTML entity
                    .replace(/"/g, "&quot;")    // Replace " with HTML entity
                    .replace(/'/g, "&#039;");   // Replace ' with HTML entity
            }
        }
//////////////////////////////////8. App Initialization
/*Creates a new instance of the "TodoApp" class.
This triggers the constructor, initializes the app, and makes it functional.*/
        // Initialize the app
        const todoApp = new TodoApp();
    </script>
</body>
</html>
